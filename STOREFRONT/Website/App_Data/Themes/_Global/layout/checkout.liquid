<!DOCTYPE html>
<html>
<head>
    <title>{{ shop.name }} &ndash; Checkout</title>

    {{ '//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js' | script_tag }}
    {{ '//ajax.aspnetcdn.com/ajax/jquery.validate/1.13.0/jquery.validate.min.js' | script_tag }}
    {{ '//ajax.aspnetcdn.com/ajax/mvc/5.1/jquery.validate.unobtrusive.min.js' | script_tag }}
    {{ '//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css' | stylesheet_tag }}
    {{ 'style.css' | asset_url | stylesheet_tag }}
    {{ '//fonts.googleapis.com/css?family=Lato' | stylesheet_tag }}
    {{ 'shopify_common.js' | shopify_asset_url | script_tag }}
    {{ 'virtocommerce.js' | shopify_asset_url | script_tag }}
    {{ content_for_header }}
    <script>
        $(function () {
            new Shopify.CountryProvinceSelector("checkout_country", "checkout_province", {});

            $("#checkout_first_name").val("{{ checkout.shipping_address.first_name }}");
            $("#checkout_last_name").val("{{ checkout.shipping_address.last_name }}");
            $("#checkout_company").val("{{ checkout.shipping_address.company }}");
            $("#checkout_address1").val("{{ checkout.shipping_address.address1 }}");
            $("#checkout_address2").val("{{ checkout.shipping_address.address2 }}");
            $("#checkout_city").val("{{ checkout.shipping_address.city }}");
            $("#checkout_country").val("{{ checkout.shipping_address.country }}");
            $("#checkout_province").val("{{ checkout.shipping_address.province }}");
            $("#checkout_zip").val("{{ checkout.shipping_address.zip }}");
            $("#checkout_phone").val("{{ checkout.shipping_address.phone }}");
            $("#shipping-methods .col-md-6").on("click", function () {
                var input = $(this).find("input");
                input.prop("checked", true);
                $.ajax({
                    type: "GET",
                    cache: false,
                    url: VirtoCommerce.url("/checkout/recalculateshippingmethod?id=" + input.val()),
                    beforeSend: function () {
                        $(".price-list li:eq(1) small").text("Updating...");
                        $(".price-list li:eq(3) small").text("Updating...");
                    },
                    success: function (jsonResponse) {
                        if (jsonResponse) {
                            $(".price-list li:eq(1) small").text(jsonResponse.stringified_shipping_price);
                            $(".price-list li:eq(3) small").text(jsonResponse.stringified_total_price);
                        }
                    }
                });
            });
            $("#payment-methods .col-md-6").on("click", function () {
                var input = $(this).find("input");
                input.prop("checked", true);
            });
            $("#billing-address-equals-shipping-address").on("change", function () {
                if ($(this).is(":checked")) {
                    $("#checkout_first_name").val("{{ checkout.shipping_address.first_name }}");
                    $("#checkout_last_name").val("{{ checkout.shipping_address.last_name }}");
                    $("#checkout_company").val("{{ checkout.shipping_address.company }}");
                    $("#checkout_address1").val("{{ checkout.shipping_address.address1 }}");
                    $("#checkout_address2").val("{{ checkout.shipping_address.address2 }}");
                    $("#checkout_city").val("{{ checkout.shipping_address.city }}");
                    $("#checkout_country").val("{{ checkout.shipping_address.country }}");
                    $("#checkout_province").val("{{ checkout.shipping_address.province }}");
                    $("#checkout_zip").val("{{ checkout.shipping_address.zip }}");
                    $("#checkout_phone").val("{{ checkout.shipping_address.phone }}");
                    $("#billing-address").hide();
                } else {
                    $("#billing-address").show();
                }
            });
        });
    </script>
</head>
<body>
    <div class="container">
        <nav class="navbar navbar-default navbar-fixed-top" style="background-color: {{ settings.color_primary }};">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="/" style="color: {{ settings.color_header_text }}; font-size: 30px; font-weight: 600;">{{ shop.name }}</a>
                </div>
            </div>
        </nav>
        <div class="row">
            {{ content_for_layout }}
        </div>
    </div>
</body>
</html>